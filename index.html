<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perjanjian Hudaibiyah & Fathu Makkah Estetik</title>
    <!-- Memuat Tailwind CSS untuk tampilan modern dan responsif --><script src="https://cdn.tailwindcss.com"></script>
    <!-- Menggunakan font Inter --><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <!-- Menggunakan Lucide Icons (sebagai pengganti Font Awesome/SVG) --><script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Mengatur font global dan latar belakang lebih cerah menjadi putih */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #ffffff; /* Putih bersih */
        }
        
        /* HEADER - Gradient dan Shadow Lebih Keras */
        .app-header {
            background-image: linear-gradient(135deg, #f0f4ff 0%, #e0e7ff 100%);
            box-shadow: 0 10px 30px rgba(129, 140, 248, 0.2);
            padding: 1.5rem;
            border-radius: 1.5rem;
        }

        /* Styling untuk tombol menu yang aktif (LEBIH VIBRANT) */
        .menu-item.active {
            background-color: #7c3aed; /* Ungu Terong */
            color: #ffffff; 
            box-shadow: 0 6px 20px rgba(124, 58, 237, 0.5);
            transform: scale(1.05);
            font-weight: 700;
        }
        .menu-item:not(.active):hover {
            background-color: #f3e8ff; /* Ungu Sangat Muda saat hover */
            color: #7c3aed;
        }

        /* Styling untuk card materi */
        .content-card {
            min-height: 450px; /* Ditingkatkan sedikit */
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.1); /* Bayangan lebih halus dan lebar */
            border-radius: 2rem; 
            border: 1px solid #f3f4f6; /* Border sangat tipis */
        }
        
        /* Animasi ringkas untuk elemen yang muncul */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94); /* Kurva animasi lebih halus */
        }
        
        /* Kuis Level Indicator (Bubble Effect) */
        .level-indicator {
            padding: 0.5rem 1rem;
            border-radius: 9999px; /* Fully rounded */
            font-size: 1rem;
            font-weight: 800;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        .level-easy { background-color: #a5f3fc; } /* Biru Muda Pastel */
        .level-medium { background-color: #fcd34d; } /* Kuning Cerah */
        .level-hard { background-color: #fda4af; } /* Pink Terang */
        .level-text-easy { color: #0891b2; }
        .level-text-medium { color: #b45309; }
        .level-text-hard { color: #be185d; }

        /* Style untuk tombol jawaban kuis */
        .quiz-option {
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
        }
        .quiz-option:hover:not(.selected) {
            background-color: #eff6ff; /* Biru Muda saat hover */
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.1);
        }
        .selected {
            border: 3px solid #f97316; /* Oranye saat dipilih */
            background-color: #fff7ed;
            box-shadow: 0 0 15px rgba(249, 115, 22, 0.3);
        }
        /* Warna Koreksi Kuis */
        .correct {
            background-color: #34d399 !important; /* Hijau Terang saat benar */
            color: white !important;
            border-color: #059669 !important;
            font-weight: 700;
            transform: scale(1.02);
            box-shadow: 0 0 20px rgba(52, 211, 153, 0.5);
        }
        .incorrect {
            background-color: #f87171 !important; /* Merah Saat Salah */
            color: white !important;
            border-color: #ef4444 !important;
            font-weight: 600;
        }

        /* Styling Tombol Aksi Kuis */
        .action-btn {
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* Bounce effect */
        }
        .action-btn:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <!-- Header Aplikasi (Diberi class app-header) --><header class="text-center mb-8 app-header mx-auto max-w-4xl">
        <h1 class="text-4xl font-extrabold text-gray-800 tracking-tight">
            <span class="text-indigo-600">Sejarah Agung</span> Akhir Masa Kenabian
        </h1>
        <p class="text-lg text-gray-500 mt-2">Perjanjian Hudaibiyah, Fathu Makkah, hingga Haji Wada'</p>
    </header>

    <!-- Menu Navigasi --><nav class="flex justify-center mb-10">
        <div class="bg-white p-2 rounded-full shadow-2xl flex space-x-2 border border-gray-100">
            <button id="menu-materi" onclick="changeMenu('materi')" class="menu-item active py-2 px-6 rounded-full text-sm font-semibold transition duration-300 flex items-center">
                <i data-lucide="book-open-text" class="w-5 h-5 mr-2"></i> Materi Inti
            </button>
            <button id="menu-langkah" onclick="changeMenu('langkah')" class="menu-item py-2 px-6 rounded-full text-sm font-semibold text-gray-700 hover:bg-purple-50 transition duration-300 flex items-center">
                <i data-lucide="list-ordered" class="w-5 h-5 mr-2"></i> Langkah Mahir
            </button>
            <button id="menu-kuis" onclick="changeMenu('kuis')" class="menu-item py-2 px-6 rounded-full text-sm font-semibold text-gray-700 hover:bg-purple-50 transition duration-300 flex items-center">
                <i data-lucide="brain-circuit" class="w-5 h-5 mr-2"></i> Tantangan Kuis
            </button>
        </div>
    </nav>

    <!-- Konten Utama (Akan diisi oleh JavaScript) --><main id="content-container" class="content-card bg-white p-6 md:p-10 shadow-xl mx-auto max-w-4xl animate-fade-in">
        <!-- Konten awal akan dimuat di sini oleh JS --></main>

    <!-- Modal (Kotak Pesan Kustom) --><div id="custom-modal" class="fixed inset-0 bg-black bg-opacity-40 z-50 flex items-center justify-center hidden modal-overlay">
        <div class="bg-white p-6 md:p-8 rounded-xl max-w-sm w-full modal-content transform transition-all duration-300 scale-95">
            <h3 id="modal-title" class="text-2xl font-black mb-4 text-center text-indigo-600">Judul Pesan</h3>
            <p id="modal-message" class="text-gray-700 mb-6 text-center text-lg leading-relaxed">Isi pesan di sini.</p>
            <button onclick="closeModal()" class="w-full bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-3 rounded-xl transition duration-300 action-btn">Oke, Siap!</button>
        </div>
    </div>

    <script>
        // Data Kuis (Total 15 soal) - Jika ada penambahan materi, kuis juga harus ditambah/disesuaikan
        const quizData = [
            // Level Mudah (Easy - 5 Soal)
            { question: "Apa tujuan utama kaum Muslimin ke Makkah saat terjadinya peristiwa Hudaibiyah?", options: ["Berperang", "Berdagang", "Melaksanakan Umrah", "Berhijrah"], answer: "Melaksanakan Umrah", level: "Mudah" },
            { question: "Di mana letak tempat perjanjian damai yang terkenal itu dilaksanakan?", options: ["Jeddah", "Madinah", "Hudaibiyah", "Makkah"], answer: "Hudaibiyah", level: "Mudah" },
            { question: "Siapa perwakilan dari kaum Quraisy yang awalnya ditunjuk untuk berunding dengan Nabi Muhammad?", options: ["Abu Sufyan", "Suhail bin Amr", "Ikrimah bin Abu Jahal", "Walid bin Mughirah"], answer: "Suhail bin Amr", level: "Mudah" },
            { question: "Salah satu poin perjanjian adalah gencatan senjata selama berapa tahun?", options: ["3 tahun", "5 tahun", "10 tahun", "20 tahun"], answer: "10 tahun", level: "Mudah" },
            { question: "Apa nama peristiwa besar setelah Perjanjian Hudaibiyah yang menjadi kemenangan bagi Muslimin?", options: ["Perang Badar", "Perang Uhud", "Fathu Makkah", "Perang Khandaq"], answer: "Fathu Makkah", level: "Mudah" },

            // Level Sedang (Medium - 5 Soal)
            { question: "Apa nama kaum yang melanggar Perjanjian Hudaibiyah sehingga memicu Fathu Makkah?", options: ["Bani Israil", "Bani Bakr", "Bani Nadir", "Bani Quraizhah"], answer: "Bani Bakr", level: "Sedang" },
            { question: "Siapa sahabat yang diutus Nabi Muhammad ke Makkah sebelum Perjanjian Hudaibiyah, yang sempat dikira terbunuh?", options: ["Ali bin Abi Thalib", "Umar bin Khattab", "Utsman bin Affan", "Abu Bakar As-Shiddiq"], answer: "Utsman bin Affan", level: "Sedang" },
            { question: "Apa nama Bai'at yang dilakukan para Sahabat di bawah pohon saat kabar terbunuhnya utusan tersiar?", options: ["Bai'at Aqabah", "Bai'at Ridhwan", "Bai'at Saqifah", "Bai'at Ansar"], answer: "Bai'at Ridhwan", level: "Sedang" },
            { question: "Berapa jumlah pasukan Muslimin yang ikut serta dalam Fathu Makkah (Penaklukan Makkah)?", options: ["1.000 orang", "3.000 orang", "7.000 orang", "10.000 orang"], answer: "10.000 orang", level: "Sedang" },
            { question: "Perjanjian Hudaibiyah dianggap sebagai 'Kemenangan yang Nyata' oleh Allah SWT. Disebutkan dalam surah apa?", options: ["Al-Fatihah", "An-Nashr", "Al-Fath", "Al-Ikhlas"], answer: "Al-Fath", level: "Sedang" },

            // Level Sulit (Hard - 5 Soal)
            { question: "Apa syarat yang paling berat dalam Perjanjian Hudaibiyah, yang kemudian terbukti menguntungkan?", options: ["Gencatan senjata 10 tahun", "Mengembalikan Muslim Makkah ke Quraisy", "Tidak boleh Umrah tahun itu", "Bebas memilih masuk Islam/Quraisy"], answer: "Mengembalikan Muslim Makkah ke Quraisy", level: "Sulit" },
            { question: "Siapa tokoh Quraisy yang menyatakan diri masuk Islam sebelum Fathu Makkah setelah diyakinkan oleh Abbas bin Abdul Muththalib?", options: ["Abu Jahal", "Abu Thalib", "Abu Sufyan", "Umayyah bin Khalaf"], answer: "Abu Sufyan", level: "Sulit" },
            { question: "Apa yang dilakukan Rasulullah SAW terhadap patung-patung berhala di sekitar Ka'bah saat Fathu Makkah?", options: ["Dibiarkan", "Dihancurkan", "Diberi kain penutup", "Dipindahkan"], answer: "Dihancurkan", level: "Sulit" },
            { question: "Kapan (Tahun Hijriah) Haji Wada' dilaksanakan?", options: ["Tahun ke-8 H", "Tahun ke-9 H", "Tahun ke-10 H", "Tahun ke-11 H"], answer: "Tahun ke-10 H", level: "Sulit" },
            { question: "Pesan utama yang disampaikan Rasulullah dalam khutbah Haji Wada' adalah...", options: ["Perintah berperang", "Larangan berdagang", "Kewajiban menjaga kehormatan dan hak sesama", "Perintah berhijrah"], answer: "Kewajiban menjaga kehormatan dan hak sesama", level: "Sulit" }
        ];

        let currentQuizIndex = 0;
        let score = 0;
        let selectedOption = null;

        // --- Fungsi Utama Navigasi ---
        function changeMenu(menu) {
            // Hapus kelas 'active' dari semua tombol
            document.querySelectorAll('.menu-item').forEach(btn => {
                btn.classList.remove('active'); 
                btn.classList.add('text-gray-700', 'hover:bg-purple-50');
            });

            // Tambahkan kelas 'active' ke tombol yang dipilih
            const selectedButton = document.getElementById(`menu-${menu}`);
            if (selectedButton) {
                selectedButton.classList.add('active');
                selectedButton.classList.remove('text-gray-700', 'hover:bg-purple-50');
            }

            // Muat konten
            const container = document.getElementById('content-container');
            container.classList.remove('animate-fade-in');
            void container.offsetWidth; // Trigger reflow
            container.classList.add('animate-fade-in');

            switch (menu) {
                case 'materi':
                    loadMateriContent();
                    break;
                case 'langkah':
                    loadLangkahContent();
                    break;
                case 'kuis':
                    startQuiz();
                    break;
            }
            // Muat ulang ikon Lucide setelah konten berubah
            lucide.createIcons();
        }

        // --- Konten Materi ---
        function loadMateriContent() {
            document.getElementById('content-container').innerHTML = `
                <div class="space-y-8">
                    <!-- Judul Konten --><h2 class="text-3xl font-black text-center text-indigo-600 mb-6 border-b-4 border-pink-200 pb-3 uppercase tracking-wider">
                        Materi Inti: Kemenangan Penuh Makna
                    </h2>

                    <!-- Bagian 1: Hudaibiyah --><div class="p-6 bg-blue-50 border-l-8 border-blue-400 rounded-xl shadow-lg transition duration-300 hover:shadow-xl hover:bg-blue-100">
                        <h3 class="text-2xl font-extrabold text-blue-700 mb-4 flex items-center">
                            <i data-lucide="handshake" class="w-7 h-7 mr-3 text-blue-500"></i> 1. Perjanjian Hudaibiyah (Tahun ke-6 H)
                        </h3>
                        <p class="text-gray-700 mb-4">
                            Perjanjian damai ini dilakukan antara Muslimin (Nabi Muhammad) dan kaum Quraisy di suatu tempat dekat Makkah. Meskipun banyak Muslim yang merasa berat dengan isinya, Allah menamainya **'Kemenangan Nyata'** karena membuka jalan dakwah yang lebih luas.
                        </p>
                        <ul class="list-none space-y-3 text-blue-600 font-semibold text-base pl-2">
                            <li class="flex items-start">
                                <i data-lucide="shield-check" class="w-5 h-5 mr-2 mt-1 text-green-500 flex-shrink-0"></i>
                                <span class="text-gray-700">Poin Kunci: Gencatan senjata selama 10 tahun.</span>
                            </li>
                            <li class="flex items-start">
                                <i data-lucide="trending-up" class="w-5 h-5 mr-2 mt-1 text-pink-500 flex-shrink-0"></i>
                                <span class="text-gray-700">Hikmah: Islam menyebar dengan pesat karena tidak ada lagi perang.</span>
                            </li>
                        </ul>
                    </div>

                    <!-- Bagian 2: Fathu Makkah --><div class="p-6 bg-green-50 border-l-8 border-green-400 rounded-xl shadow-lg transition duration-300 hover:shadow-xl hover:bg-green-100">
                        <h3 class="text-2xl font-extrabold text-green-700 mb-4 flex items-center">
                            <i data-lucide="flag-triangle-right" class="w-7 h-7 mr-3 text-green-500"></i> 2. Fathu Makkah (Penaklukan Makkah) (Tahun ke-8 H)
                        </h3>
                        <p class="text-gray-700 mb-4">
                            Terjadi karena Quraisy melanggar perjanjian. Rasulullah memimpin 10.000 pasukan. Ini adalah **Penaklukan Tanpa Darah** karena Rasulullah menunjukkan sifat pengampunan yang luar biasa kepada semua musuhnya di masa lalu.
                        </p>
                        <ul class="list-none space-y-3 text-green-600 font-semibold text-base pl-2">
                            <li class="flex items-start">
                                <i data-lucide="heart-handshake" class="w-5 h-5 mr-2 mt-1 text-indigo-500 flex-shrink-0"></i>
                                <span class="text-gray-700">Pesan Utama: Pengampunan total bagi penduduk Makkah.</span>
                            </li>
                            <li class="flex items-start">
                                <i data-lucide="zap" class="w-5 h-5 mr-2 mt-1 text-red-500 flex-shrink-0"></i>
                                <span class="text-gray-700">Tindakan Penting: Menghancurkan 360 berhala di Ka'bah.</span>
                            </li>
                        </ul>
                    </div>
                    
                    <!-- Bagian 3: Haji Wada' (BARU DITAMBAHKAN) --><div class="p-6 bg-yellow-50 border-l-8 border-yellow-400 rounded-xl shadow-lg transition duration-300 hover:shadow-xl hover:bg-yellow-100">
                        <h3 class="text-2xl font-extrabold text-yellow-700 mb-4 flex items-center">
                            <i data-lucide="mountain-sun" class="w-7 h-7 mr-3 text-yellow-500"></i> 3. Haji Wada' dan Wafatnya Rasulullah (Tahun ke-10 & 11 H)
                        </h3>
                        <p class="text-gray-700 mb-4">
                            **Haji Wada'** adalah satu-satunya haji yang dilaksanakan Rasulullah setelah hijrah, dan dinamakan 'Perpisahan' karena beliau tahu ini adalah haji terakhirnya. Di sana, beliau menyampaikan khutbah agung. 
                        </p>
                        <ul class="list-none space-y-3 text-yellow-600 font-semibold text-base pl-2">
                            <li class="flex items-start">
                                <i data-lucide="message-square" class="w-5 h-5 mr-2 mt-1 text-red-500 flex-shrink-0"></i>
                                <span class="text-gray-700">Khutbah Penting: Menekankan pentingnya menjaga hak sesama Muslim, melarang riba, dan tidak boleh ada kekerasan.</span>
                            </li>
                            <li class="flex items-start">
                                <i data-lucide="package-check" class="w-5 h-5 mr-2 mt-1 text-indigo-500 flex-shrink-0"></i>
                                <span class="text-gray-700">Pesan Terakhir: Beliau meninggalkan kita Al-Qur'an dan Sunnah (hadis) sebagai pedoman hidup.</span>
                            </li>
                        </ul>
                        <p class="text-sm text-gray-500 italic mt-4 border-t pt-3">
                            Rasulullah SAW wafat tak lama setelah Haji Wada', yaitu pada tahun ke-11 H. Namun, ajaran beliau tentang persatuan dan keadilan terus hidup di hati umat Islam.
                        </p>
                    </div>
                </div>
            `;
            lucide.createIcons();
        }

        // --- Konten Langkah-langkah ---
        function loadLangkahContent() {
            document.getElementById('content-container').innerHTML = `
                <div class="space-y-6">
                    <h2 class="text-3xl font-black text-center text-indigo-600 mb-6 border-b-4 border-indigo-200 pb-3 uppercase tracking-wider">
                        Langkah-langkah Menjadi Mahir (Tips Belajar Cepat)
                    </h2>

                    <!-- Kartu Langkah 1: Pahami Konteks --><div class="flex items-start bg-green-50 p-5 rounded-xl border border-green-300 transform hover:scale-[1.01] transition duration-300 shadow-xl">
                        <div class="flex items-center justify-center w-12 h-12 bg-green-500 text-white font-extrabold text-2xl rounded-full flex-shrink-0 mr-4 shadow-md border-2 border-green-200">1</div>
                        <div>
                            <h3 class="text-xl font-bold text-green-700 mb-1">Peta Awal: Garis Damai vs. Garis Perang</h3>
                            <p class="text-gray-600 text-sm">Bayangkan Nabi Muhammad di Madinah, Quraisy di Makkah. Hudaibiyah menjadi 'garis damai', Fathu Makkah menghilangkan garis itu total!</p>
                        </div>
                    </div>

                    <!-- Kartu Langkah 2: Pahami Perjanjian --><div class="flex items-start bg-yellow-50 p-5 rounded-xl border border-yellow-300 transform hover:scale-[1.01] transition duration-300 shadow-xl">
                         <div class="flex items-center justify-center w-12 h-12 bg-yellow-500 text-white font-extrabold text-2xl rounded-full flex-shrink-0 mr-4 shadow-md border-2 border-yellow-200">2</div>
                        <div>
                            <h3 class="text-xl font-bold text-yellow-700 mb-1">Rahasia Hudaibiyah: Taktik Jangka Panjang</h3>
                            <p class="text-gray-600 text-sm">Poin yang 'rugi' (pulang tanpa Umrah) adalah 'trik' tersembunyi Allah. Memberi waktu berdakwah bebas tanpa takut perang, sehingga Islam menyebar pesat.</p>
                        </div>
                    </div>

                    <!-- Kartu Langkah 3: Pahami Pelanggaran & Ampunan --><div class="flex items-start bg-purple-50 p-5 rounded-xl border border-purple-300 transform hover:scale-[1.01] transition duration-300 shadow-xl">
                         <div class="flex items-center justify-center w-12 h-12 bg-purple-500 text-white font-extrabold text-2xl rounded-full flex-shrink-0 mr-4 shadow-md border-2 border-purple-200">3</div>
                        <div>
                            <h3 class="text-xl font-bold text-purple-700 mb-1">Kunci Fathu Makkah: Ampunan adalah Kemenangan</h3>
                            <p class="text-gray-600 text-sm">Fathu Makkah adalah kemenangan besar (10.000 pasukan), tapi kunci suksesnya adalah **Pengampunan**. Nabi memaafkan semua musuh lama. Ini pelajaran moral yang agung!</p>
                        </div>
                    </div>

                    <!-- Kartu Langkah 4: Ambil Hikmah Haji Wada' --><div class="flex items-start bg-pink-50 p-5 rounded-xl border border-pink-300 transform hover:scale-[1.01] transition duration-300 shadow-xl">
                         <div class="flex items-center justify-center w-12 h-12 bg-pink-500 text-white font-extrabold text-2xl rounded-full flex-shrink-0 mr-4 shadow-md border-2 border-pink-200">4</div>
                        <div>
                            <h3 class="text-xl font-bold text-pink-700 mb-1">Pesan Moral Abadi: Khutbah Perpisahan</h3>
                            <p class="text-gray-600 text-sm">Haji Wada' adalah penutup semua perjuangan. Khutbahnya adalah ringkasan semua ajaran Islam: **Jaga hak sesama, jauhkan kezaliman, dan berpegang teguh pada Al-Qur'an dan Sunnah.**</p>
                        </div>
                    </div>
                </div>
            `;
            lucide.createIcons();
        }

        // --- Konten Kuis (Kode Kuis tidak berubah, hanya data kuis yang disesuaikan) ---

        function startQuiz() {
            currentQuizIndex = 0;
            score = 0;
            loadQuizQuestion();
        }

        function loadQuizQuestion() {
            if (currentQuizIndex >= quizData.length) {
                showQuizResult();
                return;
            }

            const quizItem = quizData[currentQuizIndex];
            selectedOption = null;
            const levelClass = quizItem.level === "Mudah" ? 'level-easy' : quizItem.level === "Sedang" ? 'level-medium' : 'level-hard';
            const levelTextClass = quizItem.level === "Mudah" ? 'level-text-easy' : quizItem.level === "Sedang" ? 'level-text-medium' : 'level-text-hard';

            // Mengacak urutan opsi
            const shuffledOptions = shuffleArray([...quizItem.options]);

            const optionsHtml = shuffledOptions.map(option => `
                <button onclick="selectOption(this, '${option.replace(/'/g, "\\'")}')"
                        class="quiz-option w-full text-left p-4 bg-white text-gray-800 rounded-xl border-2 border-gray-200 transition duration-150 hover:border-indigo-400">
                    <span class="font-medium">${option}</span>
                </button>
            `).join('');

            document.getElementById('content-container').innerHTML = `
                <div class="space-y-6">
                    <div class="flex justify-between items-center mb-6 border-b pb-4 border-gray-100">
                        <h2 class="text-2xl font-black text-gray-800">Tantangan Kuis PAI</h2>
                        <div class="level-indicator ${levelClass} ${levelTextClass}">
                            Level: ${quizItem.level}
                        </div>
                    </div>

                    <div class="bg-gradient-to-r from-indigo-500 to-purple-500 text-white p-6 rounded-2xl shadow-xl">
                        <p class="text-base font-semibold opacity-90 mb-2">Soal ke ${currentQuizIndex + 1} dari ${quizData.length}</p>
                        <p class="text-xl md:text-2xl font-extrabold leading-snug">${quizItem.question}</p>
                    </div>

                    <div id="quiz-options" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        ${optionsHtml}
                    </div>

                    <div class="pt-4 flex justify-end">
                        <button id="submit-quiz-btn" onclick="submitAnswer()"
                                class="action-btn bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transition duration-300 disabled:opacity-50 flex items-center"
                                disabled>
                            Jawab Soal! <i data-lucide="send" class="w-5 h-5 ml-2"></i>
                        </button>
                    </div>
                </div>
            `;
            lucide.createIcons();
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function selectOption(button, option) {
            // Hapus kelas selected dari semua tombol
            document.querySelectorAll('.quiz-option').forEach(btn => {
                btn.classList.remove('selected');
            });

            // Tambahkan kelas selected ke tombol yang diklik
            button.classList.add('selected');
            selectedOption = option;
            document.getElementById('submit-quiz-btn').disabled = false;
        }

        function submitAnswer() {
            if (!selectedOption) {
                showModal("Perhatian!", "Silakan pilih salah satu jawaban sebelum menekan tombol 'Jawab Soal!'.");
                return;
            }

            const currentQuestion = quizData[currentQuizIndex];
            const isCorrect = selectedOption === currentQuestion.answer;
            const optionsContainer = document.getElementById('quiz-options');
            const submitBtn = document.getElementById('submit-quiz-btn');

            // Nonaktifkan tombol dan opsi lain
            submitBtn.disabled = true;
            document.querySelectorAll('.quiz-option').forEach(btn => btn.disabled = true);

            // Beri warna pada jawaban yang dipilih dan jawaban yang benar
            optionsContainer.querySelectorAll('button').forEach(btn => {
                // Gunakan innerHTML untuk mendapatkan teks opsi, karena kita telah menambahkan span di loadQuizQuestion
                const btnText = btn.querySelector('span').textContent.trim();

                if (btnText === currentQuestion.answer) {
                    btn.classList.add('correct');
                    btn.classList.remove('selected', 'bg-white', 'text-gray-800');
                } else if (btnText === selectedOption && !isCorrect) {
                    btn.classList.add('incorrect');
                    btn.classList.remove('selected', 'bg-white', 'text-gray-800');
                }
            });

            if (isCorrect) {
                score++;
                showModal("Horeee, Hebat!", `Jawaban kamu BENAR! Poinmu sekarang: **${score}**`);
            } else {
                showModal("Aduh, Kurang Tepat!", `Jawaban yang benar adalah: **${currentQuestion.answer}**. Jangan khawatir, coba lagi di soal berikutnya!`);
            }

            // Tambahkan tombol Lanjut
            const nextButtonHtml = `
                <button onclick="nextQuiz()"
                        class="action-btn bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transition duration-300 flex items-center">
                    Soal Selanjutnya <i data-lucide="arrow-right" class="w-5 h-5 ml-2"></i>
                </button>
            `;
            // Ganti tombol submit dengan tombol lanjut setelah delay singkat
            setTimeout(() => {
                document.querySelector('.pt-4.flex').innerHTML = nextButtonHtml;
                lucide.createIcons();
            }, 1000); // Tunda sebentar agar siswa melihat hasilnya
        }

        function nextQuiz() {
            currentQuizIndex++;
            loadQuizQuestion();
        }

        function showQuizResult() {
            const percentage = ((score / quizData.length) * 100).toFixed(0);
            let message = "";
            let emoji = "";
            let color = "";

            if (percentage >= 80) {
                message = "Selamat! Kamu PINTAR sekali! Pertahankan semangat belajar PAI-mu!";
                emoji = "üöÄ";
                color = "text-green-600";
            } else if (percentage >= 50) {
                message = "Bagus! Kamu sudah menguasai sebagian besar materi. Sedikit lagi, kamu pasti MAKSIMAL!";
                emoji = "üëç";
                color = "text-yellow-600";
            } else {
                message = "Terus semangat! Jangan patah semangat, mari kita ulangi materi 'Langkah Mahir' agar kamu lebih yakin!";
                emoji = "üí™";
                color = "text-red-600";
            }

            document.getElementById('content-container').innerHTML = `
                <div class="text-center p-8 bg-white rounded-xl shadow-2xl space-y-6">
                    <div class="text-6xl">${emoji}</div>
                    <h2 class="text-4xl font-extrabold ${color}">Hasil Kuis Selesai!</h2>
                    <p class="text-gray-600 text-xl font-semibold">Skor Akhir Kamu:</p>
                    <div class="text-8xl font-black text-transparent bg-clip-text bg-gradient-to-r from-indigo-500 to-pink-500">
                        ${score} / ${quizData.length}
                    </div>
                    <p class="text-2xl font-bold text-gray-800">Persentase: ${percentage}%</p>
                    <p class="text-lg text-gray-700 mt-4">${message}</p>
                    <button onclick="changeMenu('materi')" class="action-btn bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-3 px-6 rounded-full transition duration-300 flex items-center mx-auto">
                        <i data-lucide="rotate-ccw" class="w-5 h-5 mr-2"></i> Ulangi Kuis / Review Materi
                    </button>
                </div>
            `;
            lucide.createIcons();
        }

        // --- Fungsi Modal Kustom ---
        function showModal(title, message) {
            document.getElementById('modal-title').innerHTML = title;
            document.getElementById('modal-message').innerHTML = message;
            const modal = document.getElementById('custom-modal');
            modal.classList.remove('hidden');
            // Reset scale for animation
            document.querySelector('.modal-content').classList.remove('scale-100');
            document.querySelector('.modal-content').classList.add('scale-95');

            setTimeout(() => {
                document.querySelector('.modal-content').classList.remove('scale-95');
                document.querySelector('.modal-content').classList.add('scale-100');
            }, 10);
        }

        function closeModal() {
            // Add bounce out animation
            document.querySelector('.modal-content').classList.remove('scale-100');
            document.querySelector('.modal-content').classList.add('scale-95');
            
            setTimeout(() => {
                document.getElementById('custom-modal').classList.add('hidden');
            }, 300); // Wait for animation to finish
        }

        // --- Inisialisasi Aplikasi ---
        window.onload = function() {
            changeMenu('materi'); // Muat konten 'Materi' saat pertama kali dibuka
        }
    </script>
</body>
</html>
